{
        "email_notifications": {},
        "name": "{{ job_name }}",
        {% if cluster_type == "New Jobs Cluster" and cloud_provider == "Azure" %}
        "job_clusters": [
            {
                "job_cluster_key": "{{ job_name }}",
                "new_cluster": {
                    "spark_version": "{{ dbr }}",
                    "spark_conf": {
                    "spark.databricks.delta.preview.enabled": "true"
                    },
                    "libraries": [
                        {
                          "maven": {
                            "coordinates": "com.databricks:spark-xml_2.12:0.14.0"
                          }
                        }
                      ],
                    "azure_attributes": {
                        "availability": "ON_DEMAND_AZURE",
                        "first_on_demand": 1,
                        "spot_bid_max_price": -1
                    },
                    "node_type_id": "{{ dbr }}",
                    "spark_env_vars": {
                        "PYSPARK_PYTHON": "/databricks/python3/bin/python3"
                    },
                    "enable_elastic_disk": true,
                    "num_workers": {{ worker_node_count }}
                }
            }
        ],
        {% endif %}
        {% if cluster_type == "New Jobs Cluster" and cloud_provider == "AWS" %}
        "job_clusters": [
            {
                "job_cluster_key": "{{ job_name }}",
                "new_cluster": {
                    "spark_version": "{{ dbr }}",
                    "spark_conf": {
                    "spark.databricks.delta.preview.enabled": "true"
                    },
                  "libraries": [
                        {
                          "maven": {
                            "coordinates": "com.databricks:spark-xml_2.12:0.14.0"
                          }
                        }
                      ],
                "aws_attributes": {
                "availability": "SPOT_WITH_FALLBACK",
                "first_on_demand": 1,
                "zone_id" : "auto"
                 },
                    "node_type_id": "{{ worker_node_type_id }}",
                    "spark_env_vars": {
                        "PYSPARK_PYTHON": "/databricks/python3/bin/python3"
                    },
                    "enable_elastic_disk": true,
                    "num_workers": {{ worker_node_count }}
                }
            }
        ],
        {% endif %}
        "max_concurrent_runs": 1,
        "tasks": [
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "libraries": [
                    {
                        "maven": {
                            "coordinates": "com.databricks:spark-xml_2.12:0.14.0"
                        }
                    }
                ],
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/_init/7.2.3.1_DwCreate",
                    "base_parameters": {
                        "env": "{{ env }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "0",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "init__DwCreate"
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/_init/7.2.3.5_BatchValidation",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "0",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "init__BatchValidation",
                "depends_on": [
                    {
                        "task_key": "init__DwCreate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/_init/PhaseComplete",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "0",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "init__PhaseComplete",
                "depends_on": [
                    {
                        "task_key": "init__BatchValidation"
                    }
                ]
            },
            
            {
               {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/BatchDate",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__BatchDate",
                "depends_on": [
                    {
                        "task_key": "init__PhaseComplete"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/DimDate",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__DimDate",
                "depends_on": [
                    {
                        "task_key": "historical__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/CustomerMgmtRaw",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__CustomerMgmtRaw",
                "depends_on": [
                    {
                        "task_key": "historical__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/HR",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__HR",
                "depends_on": [
                    {
                        "task_key": "historical__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/DimTime",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__DimTime",
                "depends_on": [
                    {
                        "task_key": "historical__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/Industry",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__Industry",
                "depends_on": [
                    {
                        "task_key": "historical__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/TaxRate",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__TaxRate",
                "depends_on": [
                    {
                        "task_key": "historical__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/TradeType",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__TradeType",
                "depends_on": [
                    {
                        "task_key": "historical__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/StatusType",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__StatusType",
                "depends_on": [
                    {
                        "task_key": "historical__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/HoldingHistoryHistorical",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__HoldingHistoryHistorical",
                "depends_on": [
                    {
                        "task_key": "historical__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/ProspectRaw",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__ProspectRaw",
                "depends_on": [
                    {
                        "task_key": "historical__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/CashTransactionHistorical",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__CashTransactionHistorical",
                "depends_on": [
                    {
                        "task_key": "historical__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/DailyMarketHistorical",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__DailyMarketHistorical",
                "depends_on": [
                    {
                        "task_key": "historical__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/TradeHistorical",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__TradeHistorical",
                "depends_on": [
                    {
                        "task_key": "historical__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/TradeHistory",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__TradeHistory",
                "depends_on": [
                    {
                        "task_key": "historical__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/WatchHistoryHistorical",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__WatchHistoryHistorical",
                "depends_on": [
                    {
                        "task_key": "historical__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/FinwireCmp",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__FinwireCmp",
                "depends_on": [
                    {
                        "task_key": "historical__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/FinwireSec",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__FinwireSec",
                "depends_on": [
                    {
                        "task_key": "historical__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/FinwireFin",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__FinwireFin",
                "depends_on": [
                    {
                        "task_key": "historical__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/Prospect",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__Prospect",
                "depends_on": [
                    {
                        "task_key": "historical__ProspectRaw"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/DimCompany",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__DimCompany",
                "depends_on": [
                    {
                        "task_key": "historical__FinwireCmp"
                    },
                    {
                        "task_key": "historical__Industry"
                    },
                    {
                        "task_key": "historical__StatusType"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/DimCustomer",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__DimCustomer",
                "depends_on": [
                    {
                        "task_key": "historical__TaxRate"
                    },
                    {
                        "task_key": "historical__Prospect"
                    },
                    {
                        "task_key": "historical__CustomerMgmtRaw"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/DimBroker",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__DimBroker",
                "depends_on": [
                    {
                        "task_key": "historical__HR"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/DimSecurity",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__DimSecurity",
                "depends_on": [
                    {
                        "task_key": "historical__DimCompany"
                    },
                    {
                        "task_key": "historical__FinwireSec"
                    },
                    {
                        "task_key": "historical__FinwireCmp"
                    },
                    {
                        "task_key": "historical__StatusType"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/DimAccount",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__DimAccount",
                "depends_on": [
                    {
                        "task_key": "historical__DimBroker"
                    },
                    {
                        "task_key": "historical__DimCustomer"
                    },
                    {
                        "task_key": "historical__CustomerMgmtRaw"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/FactWatches",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__FactWatches",
                "depends_on": [
                    {
                        "task_key": "historical__WatchHistoryHistorical"
                    },
                    {
                        "task_key": "historical__DimCustomer"
                    },
                    {
                        "task_key": "historical__DimSecurity"
                    },
                    {
                        "task_key": "historical__DimDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/Financial",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__Financial",
                "depends_on": [
                    {
                        "task_key": "historical__FinwireCmp"
                    },
                    {
                        "task_key": "historical__FinwireFin"
                    },
                    {
                        "task_key": "historical__DimCompany"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/DimTrade",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__DimTrade",
                "depends_on": [
                    {
                        "task_key": "historical__StatusType"
                    },
                    {
                        "task_key": "historical__TradeType"
                    },
                    {
                        "task_key": "historical__TradeHistorical"
                    },
                    {
                        "task_key": "historical__TradeHistory"
                    },
                    {
                        "task_key": "historical__DimDate"
                    },
                    {
                        "task_key": "historical__DimTime"
                    },
                    {
                        "task_key": "historical__DimSecurity"
                    },
                    {
                        "task_key": "historical__DimAccount"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/FactMarketHistory",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__FactMarketHistory",
                "depends_on": [
                    {
                        "task_key": "historical__DailyMarketHistorical"
                    },
                    {
                        "task_key": "historical__Financial"
                    },
                    {
                        "task_key": "historical__DimDate"
                    },
                    {
                        "task_key": "historical__DimSecurity"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/FactCashBalances",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__FactCashBalances",
                "depends_on": [
                    {
                        "task_key": "historical__CashTransactionHistorical"
                    },
                    {
                        "task_key": "historical__DimAccount"
                    },
                    {
                        "task_key": "historical__DimDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/FactHoldings",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__FactHoldings",
                "depends_on": [
                    {
                        "task_key": "historical__HoldingHistoryHistorical"
                    },
                    {
                        "task_key": "historical__DimTrade"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/_init/7.2.3.5_BatchValidation",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__BatchValidation",
                "depends_on": [
                        { "task_key": "historical__BatchDate"},
                        { "task_key": "historical__CashTransactionHistorical"},
                        { "task_key": "historical__CustomerMgmtRaw"},
                        { "task_key": "historical__DailyMarketHistorical"},
                        { "task_key": "historical__DimAccount"},
                        { "task_key": "historical__DimBroker"},
                        { "task_key": "historical__DimCompany"},
                        { "task_key": "historical__DimCustomer"},
                        { "task_key": "historical__DimDate"},
                        { "task_key": "historical__DimSecurity"},
                        { "task_key": "historical__DimTime"},
                        { "task_key": "historical__DimTrade"},
                        { "task_key": "historical__FactCashBalances"},
                        { "task_key": "historical__FactHoldings"},
                        { "task_key": "historical__FactMarketHistory"},
                        { "task_key": "historical__FactWatches"},
                        { "task_key": "historical__Financial"},
                        { "task_key": "historical__FinwireCmp"},
                        { "task_key": "historical__FinwireFin"},
                        { "task_key": "historical__FinwireSec"},
                        { "task_key": "historical__HoldingHistoryHistorical"},
                        { "task_key": "historical__HR"},
                        { "task_key": "historical__Industry"},
                        { "task_key": "historical__Prospect"},
                        { "task_key": "historical__ProspectRaw"},
                        { "task_key": "historical__StatusType"},
                        { "task_key": "historical__TaxRate"},
                        { "task_key": "historical__TradeHistorical"},
                        { "task_key": "historical__TradeHistory"},
                        { "task_key": "historical__TradeType"},
                        { "task_key": "historical__WatchHistoryHistorical"}
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/_init/PhaseComplete",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__PhaseComplete",
                "depends_on": [
                        { "task_key": "historical__BatchValidation"}

                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/Audit",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "1",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "historical__audit",
                "depends_on": [
                    {
                        "task_key": "historical__PhaseComplete"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/BatchDate",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "2",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update1__BatchDate",
                "depends_on": [
                    {
                        "task_key": "historical__audit"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/Account",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "2",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update1__Account",
                "depends_on": [
                    {
                        "task_key": "Update1__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/ProspectRaw",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "2",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update1__ProspectRaw",
                "depends_on": [
                    {
                        "task_key": "Update1__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/Prospect",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "2",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update1__Prospect",
                "depends_on": [
                    {
                        "task_key": "Update1__ProspectRaw"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/Customer",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "2",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update1__Customer",
                "depends_on": [
                    {
                        "task_key": "Update1__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/incremental/DimCustomer",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "2",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update1__DimCustomer",
                "depends_on": [
                    {
                        "task_key": "Update1__Prospect"
                    },
                    {
                        "task_key": "Update1__BatchDate"
                    },
                     {
                        "task_key": "Update1__Customer"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/incremental/DimAccount",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "2",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update1__DimAccount",
                "depends_on": [
                    {
                        "task_key": "Update1__DimCustomer"
                    },
                    {
                        "task_key": "Update1__Account"
                    },
                    {
                        "task_key": "Update1__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/TradeIncremental",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "2",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update1__TradeIncremental",
                "depends_on": [
                    {
                        "task_key": "Update1__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/incremental/DimTrade",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "2",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update1__DimTrade",
                "depends_on": [
                    {
                        "task_key": "Update1__TradeIncremental"
                    },
                    {
                        "task_key": "Update1__DimAccount"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/WatchHistoryHistorical",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "2",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update1__WatchHistoryHistorical",
                "depends_on": [
                    {
                        "task_key": "Update1__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/FactWatches",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "2",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update1__FactWatches",
                "depends_on": [
                    {
                        "task_key": "Update1__WatchHistoryHistorical"
                    },
                    {
                        "task_key": "Update1__DimCustomer"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/DailyMarketHistorical",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "2",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update1__DailyMarketHistorical",
                "depends_on": [
                    {
                        "task_key": "Update1__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/FactMarketHistory",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "2",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update1__FactMarketHistory",
                "depends_on": [
                    {
                        "task_key": "Update1__DailyMarketHistorical"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/CashTransactionHistorical",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "2",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update1__CashTransactionHistorical",
                "depends_on": [
                    {
                        "task_key": "Update1__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/FactCashBalances",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "2",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update1__FactCashBalances",
                "depends_on": [
                    {
                        "task_key": "Update1__CashTransactionHistorical"
                    },
                    {
                        "task_key": "Update1__DimAccount"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/HoldingHistoryHistorical",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "2",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update1__HoldingHistoryHistorical",
                "depends_on": [
                    {
                        "task_key": "Update1__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/incremental/FactHoldings",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "2",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update1__FactHoldings",
                "depends_on": [
                    {
                        "task_key": "Update1__HoldingHistoryHistorical"
                    },
                    {
                        "task_key": "Update1__DimTrade"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/_init/7.2.3.5_BatchValidation",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "2",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update1__BatchValidation",
                "depends_on": [
                        { "task_key": "Update1__DimAccount"},
                        { "task_key": "Update1__DimTrade"},
                        { "task_key": "Update1__DimCustomer"},
                        { "task_key": "Update1__FactCashBalances"},
                        { "task_key": "Update1__FactHoldings"},
                        { "task_key": "Update1__FactMarketHistory"},
                        { "task_key": "Update1__FactWatches"},
                        { "task_key": "Update1__Prospect"}
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/_init/PhaseComplete",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "2",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update1__PhaseComplete",
                "depends_on": [
                        { "task_key": "Update1__BatchValidation"}

                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/Audit",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "2",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update1__audit",
                "depends_on": [
                    {
                        "task_key": "Update1__PhaseComplete"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/BatchDate",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "3",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update2__BatchDate",
                "depends_on": [
                    {
                        "task_key": "Update1__audit"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/Account",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "2",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update2__Account",
                "depends_on": [
                    {
                         "task_key": "Update2__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/ProspectRaw",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "3",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update2__ProspectRaw",
                "depends_on": [
                    {
                         "task_key": "Update2__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/Prospect",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "3",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update2__Prospect",
                "depends_on": [
                    {
                        "task_key": "Update2__ProspectRaw"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/Customer",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "3",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update2__Customer",
                "depends_on": [
                    {
                         "task_key": "Update2__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/incremental/DimCustomer",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "3",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update2__DimCustomer",
                "depends_on": [
                    {
                        "task_key": "Update2__Prospect"
                    },
                    {
                        "task_key": "Update2__Customer"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/incremental/DimAccount",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "3",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update2__DimAccount",
                "depends_on": [
                    {
                        "task_key": "Update2__DimCustomer"
                    },
                    {
                        "task_key": "Update2__Account"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/TradeIncremental",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "3",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update2__TradeIncremental",
                "depends_on": [
                    {
                         "task_key": "Update2__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/incremental/DimTrade",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "3",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update2__DimTrade",
                "depends_on": [
                    {
                        "task_key": "Update2__TradeIncremental"
                    },
                    {
                        "task_key": "Update2__DimAccount"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/WatchHistoryHistorical",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "3",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update2__WatchHistoryHistorical",
                "depends_on": [
                    {
                         "task_key": "Update2__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/FactWatches",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "3",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update2__FactWatches",
                "depends_on": [
                    {
                        "task_key": "Update2__WatchHistoryHistorical"
                    },
                    {
                        "task_key": "Update2__DimCustomer"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/DailyMarketHistorical",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "3",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update2__DailyMarketHistorical",
                "depends_on": [
                    {
                         "task_key": "Update2__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/FactMarketHistory",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "3",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update2__FactMarketHistory",
                "depends_on": [
                    {
                        "task_key": "Update2__DailyMarketHistorical"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/CashTransactionHistorical",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "3",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update2__CashTransactionHistorical",
                "depends_on": [
                    {
                         "task_key": "Update2__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/FactCashBalances",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "3",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update2__FactCashBalances",
                "depends_on": [
                    {
                        "task_key": "Update2__CashTransactionHistorical"
                    },
                    {
                        "task_key": "Update2__DimAccount"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/HoldingHistoryHistorical",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "3",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update2__HoldingHistoryHistorical",
                "depends_on": [
                    {
                         "task_key": "Update2__BatchDate"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/incremental/FactHoldings",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "3",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update2__FactHoldings",
                "depends_on": [
                    {
                        "task_key": "Update2__HoldingHistoryHistorical"
                    },
                    {
                        "task_key": "Update2__DimTrade"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/_init/7.2.3.5_BatchValidation",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "3",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update2__BatchValidation",
                "depends_on": [
                        { "task_key": "Update2__DimAccount"},
                        { "task_key": "Update2__DimTrade"},
                        { "task_key": "Update2__DimCustomer"},
                        { "task_key": "Update2__FactCashBalances"},
                        { "task_key": "Update2__FactHoldings"},
                        { "task_key": "Update2__FactMarketHistory"},
                        { "task_key": "Update2__FactWatches"},
                        { "task_key": "Update2__Prospect"}
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/_init/PhaseComplete",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "3",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update2__PhaseComplete",
                "depends_on": [
                        { "task_key": "Update2__BatchValidation"}
                  

                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/historical/Audit",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "3",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "Update2__audit",
                "depends_on": [
                    {
                        "task_key": "Update2__PhaseComplete"
                    }
                ]
            },
            {
                {% if cluster_type == "Existing Interactive" %}
                "existing_cluster_id": "{{ cluster_id }}",
                {% elif cluster_type == "New Jobs Cluster" %}
                "job_cluster_key": "{{ job_name }}",
                {% endif %}
                "notebook_task": {
                    "notebook_path": "{{ repo_directory }}/tpc-di__benchmark_run/tools/Appendix_v1.1.0/0300 Audit",
                    "base_parameters": {
                        "env": "{{ env  }}",
                        "files_directory": "{{ files_directory }}",
                        "batch_id": "3",
                        "scale_factor": "{{ scale_factor }}"
                    }
                },
                "email_notifications": {},
                "task_key": "final__audit",
                "depends_on": [
                    {
                        "task_key": "Update2__audit"
                    }
                ]
            }
        ]
    }